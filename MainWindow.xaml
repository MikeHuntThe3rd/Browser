<Window x:Class="Browser.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Browser"
        xmlns:cef="clr-namespace:CefSharp.Wpf;assembly=CefSharp.Wpf"
        mc:Ignorable="d"
        WindowStyle="None"
        Background="Transparent"
        ResizeMode="CanResize"
        Loaded="Window_Loaded"
        Title="MainWindow">

    <Window.Resources>
        <!-- Tab Header DataTemplate -->
        <DataTemplate x:Key="tab_header_button_wrapper">
            <Grid MouseDown="Tab_Drag">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="30"/>
                </Grid.ColumnDefinitions>
                <Label Grid.Column="0" Content="cigi" HorizontalAlignment="Left" Padding="6,0"/>
                <Button Grid.Column="1" Content="×" Click="close_tab_Click"
                        Background="Transparent" BorderThickness="0" Foreground="#B22222"
                        FontWeight="Bold" Cursor="Hand"/>
            </Grid>
        </DataTemplate>

        <!-- Chrome-like TabItem Style -->
        <Style TargetType="TabItem" x:Key="ChromeTabItemStyle">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="Margin" Value="0,0,4,0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Grid>
                            <Border x:Name="Bd"
                                    Background="Transparent"
                                    BorderBrush="Transparent"
                                    BorderThickness="0"
                                    CornerRadius="8,8,0,0"
                                    Padding="{TemplateBinding Padding}">
                                <ContentPresenter x:Name="ContentSite"
                                                  VerticalAlignment="Center"
                                                  HorizontalAlignment="Center"
                                                  ContentSource="Header"
                                                  Margin="8,0"/>
                            </Border>

                            <!-- Selected underline -->
                            <Border x:Name="SelectedUnderline"
                                    Height="3"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Bottom"
                                    Background="Transparent"
                                    CornerRadius="0,0,8,8"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="White"/>
                                <Setter TargetName="Bd" Property="BorderBrush" Value="#DDDDDD"/>
                                <Setter TargetName="Bd" Property="BorderThickness" Value="1,1,1,0"/>
                                <Setter TargetName="SelectedUnderline" Property="Background" Value="#4285F4"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#F5F5F5"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Foreground" Value="#888"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Chrome-like TabControl Style -->
        <Style TargetType="TabControl" x:Key="ChromeTabControlStyle">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabControl">
                        <Grid Background="#EEE" KeyboardNavigation.TabNavigation="Local">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="36"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Tabs panel -->
                            <TabPanel x:Name="HeaderPanel"
                                      Grid.Row="0"
                                      IsItemsHost="True"
                                      Background="#F1F3F4"
                                      Margin="8,0,8,0"
                                      Panel.ZIndex="1"
                                      KeyboardNavigation.TabIndex="1"/>

                            <!-- Content -->
                            <Border Grid.Row="1"
                                    Background="White"
                                    BorderBrush="#DDDDDD"
                                    BorderThickness="1"
                                    CornerRadius="0,0,8,8"
                                    KeyboardNavigation.TabIndex="2"
                                    KeyboardNavigation.DirectionalNavigation="Contained">
                                <ContentPresenter x:Name="PART_SelectedContentHost" ContentSource="SelectedContent" Margin="8"/>
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Window control buttons (minimize, maximize, close, new tab) -->
        <Style TargetType="Button" x:Key="WindowControlButtonStyle">
            <Setter Property="Width" Value="20"/>
            <Setter Property="Height" Value="28"/>
            <Setter Property="Margin" Value="2,3,2,3"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#444"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="4" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#E8E8E8"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#C0C0C0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </Window.Resources>
    <!-- Main Grid -->
    <Grid x:Name="Tabgrid">
        <TabControl x:Name="tabs"
                    Style="{StaticResource ChromeTabControlStyle}"
                    ItemContainerStyle="{StaticResource ChromeTabItemStyle}">

            <!-- TabControl Header + Window Controls -->
            <TabControl.Template>
                <ControlTemplate TargetType="TabControl">
                    <Grid Background="#EEE" MouseDown="Drag" x:Name="DragBar">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="36"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="5*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TabPanel x:Name="HeaderPanel" IsItemsHost="True" Grid.Column="0" Margin="8,0"/>
                            <Grid Grid.Column="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" /> 
                                    <ColumnDefinition Width="*" /> 
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Button Style="{StaticResource WindowControlButtonStyle}" Grid.Column="0" Content="+" ToolTip="Új lap" Click="NewTab_Click" Margin="0,0,4,0"/>
                                <Button Style="{StaticResource WindowControlButtonStyle}" Grid.Column="1" Content="—" ToolTip="Minimalizál" Click="Minimize_Click" Margin="0,0,4,0"/>
                                <Button Style="{StaticResource WindowControlButtonStyle}" Grid.Column="2" Content="□" ToolTip="Maximalizál" Click="Maximize_Click" Margin="0,0,4,0"/>
                                <Button Style="{StaticResource WindowControlButtonStyle}" Grid.Column="3" Content="X" ToolTip="Bezár" Click="Close_Click" Foreground="#B22222"/>
                            </Grid>
                        </Grid>

                        <ContentPresenter x:Name="PART_SelectedContentHost" ContentSource="SelectedContent" Grid.Row="1" Margin="8"/>
                    </Grid>
                </ControlTemplate>
            </TabControl.Template>
        </TabControl>
    </Grid>
</Window>
